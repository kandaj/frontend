# Dummy deployment workflow for testing DORA metrics
name: CI-Deploy-TWeb-TAPI-TTV-to-Live
on:
  workflow_dispatch:
    inputs:
      telescopeWeb:
        description: "Deploy Telescope Web to Live"
        required: true
        default: false
        type: boolean
      telescopeAPI:
        description: "Deploy Telescope API to Live"
        required: true
        default: false
        type: boolean
      telescopeTV:
        description: "Deploy Telescope TV to Live"
        required: true
        default: false
        type: boolean
      shouldFail:
        description: "Simulate deployment failure"
        required: false
        default: false
        type: boolean

jobs:
  Deploy-TWeb-to-Live:
    name: Deploy TWeb to Live
    runs-on: ubuntu-latest
    if: ${{ inputs.telescopeWeb }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Simulate TWeb Deployment
        run: |
          echo "üöÄ Deploying Telescope Web to Production..."
          echo "Commit SHA: ${{ github.sha }}"
          sleep 5
          echo "‚úÖ TWeb deployed successfully!"

      - name: Fail if requested
        if: ${{ inputs.shouldFail }}
        run: |
          echo "‚ùå Simulating deployment failure"
          exit 1

  Deploy-TAPI-to-Live:
    name: Deploy TAPI to Live
    runs-on: ubuntu-latest
    if: ${{ inputs.telescopeAPI }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Simulate TAPI Deployment
        run: |
          echo "üöÄ Deploying Telescope API to Production..."
          echo "Commit SHA: ${{ github.sha }}"
          sleep 5
          echo "‚úÖ TAPI deployed successfully!"

      - name: Fail if requested
        if: ${{ inputs.shouldFail }}
        run: |
          echo "‚ùå Simulating deployment failure"
          exit 1

  Deploy-TTV-to-Live:
    name: Deploy TTV to Live
    runs-on: ubuntu-latest
    if: ${{ inputs.telescopeTV }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Simulate TTV Deployment
        run: |
          echo "üöÄ Deploying Telescope TV to Production..."
          echo "Commit SHA: ${{ github.sha }}"
          sleep 5
          echo "‚úÖ TTV deployed successfully!"

      - name: Fail if requested
        if: ${{ inputs.shouldFail == 'true' }}
        run: |
          echo "‚ùå Simulating deployment failure"
          exit 1

  Summary:
    name: Deployment Summary
    runs-on: ubuntu-latest
    needs: [Deploy-TWeb-to-Live, Deploy-TAPI-to-Live, Deploy-TTV-to-Live]
    if: always()
    steps:
      - name: Show Summary
        run: |
          echo "üìä Deployment Summary"
          echo "===================="
          echo "TWeb: ${{ inputs.telescopeWeb && '‚úÖ Deployed' || '‚è≠Ô∏è  Skipped' }}"
          echo "TAPI: ${{ inputs.telescopeAPI && '‚úÖ Deployed' || '‚è≠Ô∏è  Skipped' }}"
          echo "TTV: ${{ inputs.telescopeTV && '‚úÖ Deployed' || '‚è≠Ô∏è  Skipped' }}"
          echo ""
          echo "This workflow will trigger the DORA metrics collection!"